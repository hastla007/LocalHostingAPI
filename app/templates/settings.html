{% extends "base.html" %}
{% block content %}
  <section class="card">
    <h2>Retention Settings</h2>
    <form method="post" class="retention-system-form">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
      <input type="hidden" name="action" value="update_retention" />

      <div class="settings-columns">
        <div class="settings-column">
          <div class="form-grid">
            <label for="retention_min_hours">Minimum retention (hours)</label>
            <input
              type="number"
              id="retention_min_hours"
              name="retention_min_hours"
              min="0"
              step="0.1"
              value="{{ config.retention_min_hours }}"
              required
            />

            <label for="retention_max_hours">Maximum retention (hours)</label>
            <input
              type="number"
              id="retention_max_hours"
              name="retention_max_hours"
              min="0"
              step="0.1"
              value="{{ config.retention_max_hours }}"
              required
            />

            <label for="retention_hours">Default retention (hours)</label>
            <input
              type="number"
              id="retention_hours"
              name="retention_hours"
              min="0"
              step="0.1"
              value="{{ config.retention_hours }}"
              required
            />
          </div>
        </div>
        <div class="settings-column">
          <div class="system-settings">
            <h3>System Settings</h3>
            <table class="settings-table">
              <tbody>
                <tr>
                  <th scope="row">
                    <label for="max_upload_size_mb">Maximum upload size (MB)</label>
                  </th>
                  <td>
                    <input
                      type="number"
                      id="max_upload_size_mb"
                      name="max_upload_size_mb"
                      min="1"
                      step="0.1"
                      value="{{ config.max_upload_size_mb }}"
                      required
                      class="half-width-input"
                    />
                  </td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <div class="form-actions">
        <button type="submit" class="button primary">Save</button>
      </div>
    </form>
    <p>
      Each upload can now request its own retention period within the allowed range. Values outside of the configured bounds will be
      rejected by the API and the dashboard uploader. You can also adjust the maximum upload size accepted by the service without
      restarting the container.
    </p>
  </section>
  <section class="card">
    <h2>UI Authentication</h2>
    <form method="post" class="form-grid auth-grid">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
      <input type="hidden" name="action" value="update_ui_auth" />

      <label for="ui_auth_enabled" class="checkbox-label">
        <input
          type="checkbox"
          id="ui_auth_enabled"
          name="ui_auth_enabled"
          {% if config.ui_auth_enabled %}checked{% endif %}
        />
        Require login for dashboard pages
      </label>

      <label for="ui_username">Username</label>
      <input
        type="text"
        id="ui_username"
        name="ui_username"
        value="{{ config.ui_username }}"
        autocomplete="username"
      />

      <label for="ui_password">New password</label>
      <input
        type="password"
        id="ui_password"
        name="ui_password"
        autocomplete="new-password"
        placeholder="Leave blank to keep current password"
      />

      <label for="ui_password_confirm">Confirm password</label>
      <input
        type="password"
        id="ui_password_confirm"
        name="ui_password_confirm"
        autocomplete="new-password"
        placeholder="Repeat new password"
      />

      <p class="form-help">
        Authentication is optional by default. Enable it to require users to log in before accessing the dashboard. Leave the
        password fields blank to keep the existing password.
      </p>

      <button type="submit" class="button primary">Update Authentication</button>
    </form>
  </section>
{% endblock %}
